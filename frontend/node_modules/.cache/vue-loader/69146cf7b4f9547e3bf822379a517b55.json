{"remainingRequest":"/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/src/components/ProductBox.vue?vue&type=style&index=0&id=9cfe2ae8&lang=css","dependencies":[{"path":"/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/src/components/ProductBox.vue","mtime":1684581808806},{"path":"/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/node_modules/css-loader/dist/cjs.js","mtime":1681917296340},{"path":"/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/node_modules/vue-loader-v16/dist/stylePostLoader.js","mtime":1681917297994},{"path":"/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/node_modules/postcss-loader/src/index.js","mtime":1681917297263},{"path":"/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1681917295994},{"path":"/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/node_modules/vue-loader-v16/dist/index.js","mtime":1681917297993}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgLnR1cm5pbmdfYnV0dG9uIHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiAzMHB4OwogICAgaGVpZ2h0OiA1MHB4OwogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgbGluZS1oZWlnaHQ6IDUwcHg7CiAgICB0b3A6IDUwJTsKICAgIG1hcmdpbi10b3A6IC0yNXB4OwogICAgYm9yZGVyOiAxcHggc29saWQgI2ZmZjsKICAgIG9wYWNpdHk6IDAuMzsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIGNvbG9yOiAjZmZmOwogICAgYmFja2dyb3VuZDogYmxhY2s7CiAgfQogICNyaWdodCB7CiAgICBsZWZ0OiAxMDAlOwogICAgbWFyZ2luLWxlZnQ6IC0zMHB4OwogIH0K"},{"version":3,"sources":["/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/src/components/ProductBox.vue"],"names":[],"mappings":";EA4LE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACd,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAClB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACZ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACjB,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IACR,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IACjB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACtB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IACZ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACf,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EACnB;EACA,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACL,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACV,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EACpB","file":"/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/src/components/ProductBox.vue","sourceRoot":"","sourcesContent":["<template>\n  <div class=\"column is-4\">\n    <div class=\"card\">\n      <div class=\"card-image\">\n        <figure class=\"image is-4by3\">\n          <img :src=\"path\" alt=\"Placeholder image\" />\n        </figure>\n        <div class=\"button\" id=\"left\" v-show=\"index > 0\" @click=\"btnLeft\">&lt;</div>\n        <div class=\"button\" id=\"right\" v-show=\"index < product.image_num - 1\" @click=\"btnRight\">\n          &gt;\n        </div>\n      </div>\n      <div class=\"card-content\">\n        <div class=\"media\">\n          <div class=\"media-content\">\n            <p class=\"title is-4\">名称:{{ product.name }}</p>\n            <p v-if=\"is_admin\" class=\"title is-6\">ID:{{ product.id }}</p>\n          </div>\n        </div>\n\n        <div class=\"content\">描述：{{ product.description }}</div>\n      </div>\n      <footer v-if=\"is_admin\" class=\"card-footer\">\n        <button class=\"button is-primary\" @click=\"release(true)\">通过</button>\n        <button class=\"button is-danger\" @click=\"release(false)\">拒绝</button>\n        <div class=\"notification is-danger\" v-if=\"errors.length\">\n          <p v-for=\"error in errors\" v-bind:key=\"error\">{{ error }}</p>\n        </div>\n      </footer>\n      <footer v-if=\"is_user\" class=\"card-footer\">\n        <div class=\"control\">\n          <button class=\"button is-dark\" @click=\"to_cart\">加入购物车</button>\n        </div>\n        <div class=\"control\">\n          <button class=\"button is-dark\" @click=\"to_order\">立即购买</button>\n        </div>\n      </footer>\n    </div>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\";\n  import { toast } from \"bulma-toast\";\n  export default {\n    data() {\n      return {\n        path: \"\",\n        index: 0,\n        is_admin: false,\n        is_user: false,\n        errors: [],\n      };\n    },\n    props: {\n      product: { type: Object },\n      type: { type: String },\n      review: { type: String },\n    },\n    methods: {\n      getImg() {\n        this.path = \"http://119.3.184.138:80/file/product/img/\" + this.product.id + \"-\" + this.index + \".png\";\n      },\n      btnLeft() {\n        this.index--;\n        this.getImg();\n      },\n      btnRight() {\n        this.index++;\n        this.getImg();\n      },\n      to_order() {\n        var item = {\n          id: this.product.id,\n          count: 1,\n          shop_name: this.product.shop_name,\n          price: this.product.price,\n        };\n        var items = [item];\n        this.$router.push({ name: \"order\", params: { items: items, type: 1 } });\n      },\n      //上传审批结果\n      release(approved) {\n        this.errors = [];\n        var formData = {\n          authorize: JSON.parse(localStorage.getItem(\"authorize\") || \"{}\"),\n          info_id: this.product.id,\n          approved: approved,\n          review: JSON.parse(localStorage.getItem(\"authorize\") || \"{}\").username == \"admin\",\n        };\n        console.log(formData);\n        var url;\n        if (this.review === \"create\") url = \"/api/product/create/approval\";\n        else if (this.review === \"modify\") url = \"/api/product/modify/approval\";\n        axios\n          .post(url, formData)\n          .then((response) => {\n            console.log(response);\n            if (response.status == 200) {\n              toast({\n                message: \"完成商品审核！\",\n                type: \"is-success\",\n                dismissible: true,\n                pauseOnHover: true,\n                duration: 2000,\n                position: \"center\",\n              });\n            } else {\n              toast({\n                message: response.status,\n                type: \"warning\",\n                dismissible: true,\n                pauseOnHover: true,\n                duration: 2000,\n                position: \"center\",\n              });\n            }\n          })\n          .catch((error) => {\n            console.log(error);\n            if (error.response) {\n              this.errors.push(error.response.data);\n              console.log(JSON.stringify(error.response));\n            } else if (error.message) {\n              // this.errors.push(\"Something went wrong. Please try again\");\n              console.log(error.response);\n            }\n          });\n      },\n      //将商品添加进入购物车\n      to_cart() {\n        this.errors = [];\n        var formData = {\n          authorize: JSON.parse(localStorage.getItem(\"authorize\") || \"{}\"),\n          product_id: this.product.id,\n        };\n        console.log(formData);\n        var url = \"/api/cart/create\";\n        axios\n          .post(url, formData)\n          .then((response) => {\n            console.log(response);\n            if (response.status == 200) {\n              toast({\n                message: \"添加购物车成功！\",\n                type: \"is-success\",\n                dismissible: true,\n                pauseOnHover: true,\n                duration: 2000,\n                position: \"bottom-right\",\n              });\n            } else {\n              toast({\n                message: response.status,\n                type: \"warning\",\n                dismissible: true,\n                pauseOnHover: true,\n                duration: 2000,\n                position: \"bottom-right\",\n              });\n            }\n          })\n          .catch((error) => {\n            console.log(error);\n            if (error.response) {\n              this.errors.push(error.response.data);\n              console.log(JSON.stringify(error.response));\n            } else if (error.message) {\n              // this.errors.push(\"Something went wrong. Please try again\");\n              console.log(error.response);\n            }\n          });\n      },\n    },\n    mounted() {\n      if (this.type === \"2\") {\n        this.is_user = true;\n      } else if (this.type === \"0\") {\n        this.is_admin = true;\n      }\n    },\n    created() {\n      this.getImg();\n    },\n  };\n</script>\n\n<style>\n  .turning_button {\n    position: absolute;\n    width: 30px;\n    height: 50px;\n    text-align: center;\n    line-height: 50px;\n    top: 50%;\n    margin-top: -25px;\n    border: 1px solid #fff;\n    opacity: 0.3;\n    cursor: pointer;\n    color: #fff;\n    background: black;\n  }\n  #right {\n    left: 100%;\n    margin-left: -30px;\n  }\n</style>\n"]}]}