{"remainingRequest":"/Users/biyuntian/Desktop/software engineering/git/lab_3/frontend/node_modules/babel-loader/lib/index.js!/Users/biyuntian/Desktop/software engineering/git/lab_3/frontend/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/biyuntian/Desktop/software engineering/git/lab_3/frontend/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/biyuntian/Desktop/software engineering/git/lab_3/frontend/src/views/LogIn.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/biyuntian/Desktop/software engineering/git/lab_3/frontend/src/views/LogIn.vue","mtime":1682241375570},{"path":"/Users/biyuntian/Desktop/software engineering/git/lab_3/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1681917295994},{"path":"/Users/biyuntian/Desktop/software engineering/git/lab_3/frontend/node_modules/babel-loader/lib/index.js","mtime":1681917295923},{"path":"/Users/biyuntian/Desktop/software engineering/git/lab_3/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1681917295994},{"path":"/Users/biyuntian/Desktop/software engineering/git/lab_3/frontend/node_modules/vue-loader-v16/dist/index.js","mtime":1681917297993}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9iaXl1bnRpYW4vRGVza3RvcC9zb2Z0d2FyZSBlbmdpbmVlcmluZy9naXQvbGFiXzMvZnJvbnRlbmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCB7IHRvYXN0IH0gZnJvbSAiYnVsbWEtdG9hc3QiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkxvZ0luIiwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdXNlcm5hbWU6ICIiLAogICAgICBwYXNzd29yZDogIiIsCiAgICAgIGVycm9yczogW10sCiAgICAgIHVzZXJpZDogIiIsCiAgICAgIGlkZW50aXR5OiAiIgogICAgfTsKICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICBkb2N1bWVudC50aXRsZSA9ICLnmbvpmYYiOwogIH0sCiAgbWV0aG9kczogewogICAgc3VibWl0Rm9ybTogZnVuY3Rpb24gc3VibWl0Rm9ybSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIGZvcm1EYXRhOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzLmVycm9ycyA9IFtdOwogICAgICAgICAgICAgICAgYXhpb3MuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bIkF1dGhvcml6YXRpb24iXSA9ICIiOwogICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oInRva2VuIik7CgogICAgICAgICAgICAgICAgX3RoaXMuZXJyb3JzLnNwbGljZSgwKTsKCiAgICAgICAgICAgICAgICBpZiAoIShfdGhpcy51c2VybmFtZS5sZW5ndGggPT09IDAgfHwgX3RoaXMucGFzc3dvcmQgPT09IDApKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpcy5lcnJvcnMucHVzaCgi55So5oi35ZCN5oiW5a+G56CB5LiN5b6X5Li656m6Iik7CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIGZvcm1EYXRhID0gewogICAgICAgICAgICAgICAgICB1c2VybmFtZTogX3RoaXMudXNlcm5hbWUsCiAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBfdGhpcy5wYXNzd29yZAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGZvcm1EYXRhKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMTsKICAgICAgICAgICAgICAgIHJldHVybiBheGlvcy5wb3N0KCIvYXBpL2xvZ2luIiwgZm9ybURhdGEpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzLnVzZXJpZCA9IHJlc3BvbnNlLmRhdGEudXNlcmlkOwogICAgICAgICAgICAgICAgICBfdGhpcy5pZGVudGl0eSA9IHJlc3BvbnNlLmRhdGEuaWRlbnRpdHk7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImF1dGhvcml6ZSIsIEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgICAgICB1c2VybmFtZTogX3RoaXMudXNlcm5hbWUsCiAgICAgICAgICAgICAgICAgICAgaWQ6IF90aGlzLnVzZXJpZAogICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJpZGVudGl0eSIsIF90aGlzLmlkZW50aXR5KTsgLy8gY29uc3QgdG9rZW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidXJsIikudmFsdWUKICAgICAgICAgICAgICAgICAgLy8gdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRUb2tlbicsIHRva2VuKQogICAgICAgICAgICAgICAgICAvLyBheGlvcy5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsiQXV0aG9yaXphdGlvbiJdID0gIlRva2VuICIgKyB0b2tlbgogICAgICAgICAgICAgICAgICAvLyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgidG9rZW4iLCB0b2tlbikKCiAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgdG9hc3QoewogICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIueZu+mZhuaIkOWKn++8gSIsCiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiaXMtc3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgICBkaXNtaXNzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgIHBhdXNlT25Ib3ZlcjogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAyMDAwLAogICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJib3R0b20tcmlnaHQiCiAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcoX3RoaXMuaWRlbnRpdHkpID09ICIwIikgewogICAgICAgICAgICAgICAgICAgICAgdmFyIHRvUGF0aCA9IF90aGlzLiRyb3V0ZS5xdWVyeS50byB8fCAiLyI7IC8vIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0QnV5ZXInLCB0b2tlbikKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcoX3RoaXMuaWRlbnRpdHkpID09ICIxIikgewogICAgICAgICAgICAgICAgICAgICAgdmFyIHRvUGF0aCA9IF90aGlzLiRyb3V0ZS5xdWVyeS50byB8fCAiLyI7CiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0b1BhdGgpOyAvLyB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFNlbGxlcicsIHRva2VuKQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKFN0cmluZyhfdGhpcy5pZGVudGl0eSkgPT0gIjIiKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9QYXRoID0gX3RoaXMuJHJvdXRlLnF1ZXJ5LnRvIHx8ICIvIjsgLy8gdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRBZG1pbicsIHRva2VuKQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgX3RoaXMuJHJvdXRlci5wdXNoKHRvUGF0aCk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdG9hc3QoewogICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogcmVzcG9uc2Uuc3RhdHVzLAogICAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgICAgZGlzbWlzc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICBwYXVzZU9uSG92ZXI6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMjAwMCwKICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAiYm90dG9tLXJpZ2h0IgogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgaWYgKGVycm9yLnJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IucmVzcG9uc2UuZGF0YSk7CgogICAgICAgICAgICAgICAgICAgIF90aGlzLmVycm9ycy5wdXNoKGVycm9yLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIF90aGlzLmVycm9ycy5wdXNoKCJTb21ldGhpbmcgd2VudCB3cm9uZy4gUGxlYXNlIHRyeSBhZ2FpbiIpOwoKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvci5yZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfQogIH0KfTs="},{"version":3,"sources":["/Users/biyuntian/Desktop/software engineering/git/lab_3/frontend/src/views/LogIn.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"page-log-in\">\n    <div class=\"columns\">\n      <div class=\"column is-4 is-offset-4\">\n        <h1 class=\"title\">登陆</h1>\n\n        <form @submit.prevent=\"submitForm\">\n          <div class=\"field\">\n            <label>用户名</label>\n            <div class=\"control\">\n              <input type=\"text\" class=\"input\" v-model=\"username\" />\n            </div>\n          </div>\n\n          <div class=\"field\">\n            <label>密码</label>\n            <div class=\"control\">\n              <input type=\"password\" class=\"input\" v-model=\"password\" />\n            </div>\n          </div>\n\n          <div class=\"notification is-danger\" v-if=\"errors.length\">\n            <p v-for=\"error in errors\" v-bind:key=\"error\">{{ error }}</p>\n          </div>\n\n          <div class=\"field\">\n            <div class=\"control\">\n              <button class=\"button is-dark\">登陆</button>\n            </div>\n          </div>\n\n          <hr />\n\n          <router-link to=\"/sign-up\">点击这里</router-link> 去注册!\n        </form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\";\n  import { toast } from \"bulma-toast\";\n  export default {\n    name: \"LogIn\",\n    data() {\n      return {\n        username: \"\",\n        password: \"\",\n        errors: [],\n        userid: \"\",\n        identity: \"\",\n      };\n    },\n    mounted() {\n      document.title = \"登陆\";\n    },\n    methods: {\n      async submitForm() {\n        this.errors = [];\n        axios.defaults.headers.common[\"Authorization\"] = \"\";\n        localStorage.removeItem(\"token\");\n        this.errors.splice(0);\n        if (this.username.length === 0 || this.password === 0) {\n          this.errors.push(\"用户名或密码不得为空\");\n          return;\n        }\n        const formData = {\n          username: this.username,\n          password: this.password,\n        };\n        console.log(formData);\n        await axios\n          .post(\"/api/login\", formData)\n          .then((response) => {\n            this.userid = response.data.userid;\n            this.identity = response.data.identity;\n            console.log(response);\n\n            localStorage.setItem(\"authorize\", JSON.stringify({ username: this.username, id: this.userid }));\n            localStorage.setItem(\"identity\", this.identity);\n            // const token = document.getElementById(\"url\").value\n\n            // this.$store.commit('setToken', token)\n\n            // axios.defaults.headers.common[\"Authorization\"] = \"Token \" + token\n\n            // localStorage.setItem(\"token\", token)\n            if (response.status == 200) {\n              toast({\n                message: \"登陆成功！\",\n                type: \"is-success\",\n                dismissible: true,\n                pauseOnHover: true,\n                duration: 2000,\n                position: \"bottom-right\",\n              });\n              if (String(this.identity) == \"0\") {\n                var toPath = this.$route.query.to || \"/\";\n                // this.$store.commit('setBuyer', token)\n              }\n              if (String(this.identity) == \"1\") {\n                var toPath = this.$route.query.to || \"/\";\n                console.log(toPath);\n                // this.$store.commit('setSeller', token)\n              }\n              if (String(this.identity) == \"2\") {\n                var toPath = this.$route.query.to || \"/\";\n                // this.$store.commit('setAdmin', token)\n              }\n              this.$router.push(toPath);\n            } else {\n              toast({\n                message: response.status,\n                type: \"warning\",\n                dismissible: true,\n                pauseOnHover: true,\n                duration: 2000,\n                position: \"bottom-right\",\n              });\n            }\n          })\n          .catch((error) => {\n            if (error.response) {\n              console.log(error.response.data);\n              this.errors.push(error.response.data);\n            } else {\n              this.errors.push(\"Something went wrong. Please try again\");\n              console.log(error.response);\n            }\n          });\n      },\n    },\n  };\n</script>\n"],"sourceRoot":""}]}