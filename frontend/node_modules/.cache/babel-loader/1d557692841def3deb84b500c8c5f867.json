{"remainingRequest":"/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/node_modules/babel-loader/lib/index.js!/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/src/views/LogIn.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/src/views/LogIn.vue","mtime":1683727413029},{"path":"/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1681917295994},{"path":"/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/node_modules/babel-loader/lib/index.js","mtime":1681917295923},{"path":"/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1681917295994},{"path":"/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/node_modules/vue-loader-v16/dist/index.js","mtime":1681917297993}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9iaXl1bnRpYW4vRGVza3RvcC9zb2Z0d2FyZSBlbmdpbmVlcmluZy9naXQvbGFiXzQvTGFiNC9mcm9udGVuZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlLmpzIjsKaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IHsgdG9hc3QgfSBmcm9tICJidWxtYS10b2FzdCI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiTG9nSW4iLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB1c2VybmFtZTogIiIsCiAgICAgIHBhc3N3b3JkOiAiIiwKICAgICAgZXJyb3JzOiBbXSwKICAgICAgdXNlcmlkOiAiIiwKICAgICAgaWRlbnRpdHk6ICIiCiAgICB9OwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIGRvY3VtZW50LnRpdGxlID0gIueZu+mZhiI7CiAgfSwKICBtZXRob2RzOiB7CiAgICBzdWJtaXRGb3JtOiBmdW5jdGlvbiBzdWJtaXRGb3JtKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgZm9ybURhdGE7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMuZXJyb3JzID0gW107CiAgICAgICAgICAgICAgICBheGlvcy5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsiQXV0aG9yaXphdGlvbiJdID0gIiI7CiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgidG9rZW4iKTsKCiAgICAgICAgICAgICAgICBfdGhpcy5lcnJvcnMuc3BsaWNlKDApOwoKICAgICAgICAgICAgICAgIGlmICghKF90aGlzLnVzZXJuYW1lLmxlbmd0aCA9PT0gMCB8fCBfdGhpcy5wYXNzd29yZCA9PT0gMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzLmVycm9ycy5wdXNoKCLnlKjmiLflkI3miJblr4bnoIHkuI3lvpfkuLrnqboiKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgZm9ybURhdGEgPSB7CiAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiBfdGhpcy51c2VybmFtZSwKICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IF90aGlzLnBhc3N3b3JkCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZm9ybURhdGEpOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgICAgICAgcmV0dXJuIGF4aW9zLnBvc3QoIi9hcGkvbG9naW4iLCBmb3JtRGF0YSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMudXNlcmlkID0gcmVzcG9uc2UuZGF0YS51c2VyaWQ7CiAgICAgICAgICAgICAgICAgIF90aGlzLmlkZW50aXR5ID0gcmVzcG9uc2UuZGF0YS5pZGVudGl0eTsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpOwogICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiYXV0aG9yaXplIiwgSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiBfdGhpcy51c2VybmFtZSwKICAgICAgICAgICAgICAgICAgICBpZDogX3RoaXMudXNlcmlkCiAgICAgICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImlkZW50aXR5IiwgX3RoaXMuaWRlbnRpdHkpOyAvLyBjb25zdCB0b2tlbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ1cmwiKS52YWx1ZQogICAgICAgICAgICAgICAgICAvLyB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFRva2VuJywgdG9rZW4pCiAgICAgICAgICAgICAgICAgIC8vIGF4aW9zLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWyJBdXRob3JpemF0aW9uIl0gPSAiVG9rZW4gIiArIHRva2VuCiAgICAgICAgICAgICAgICAgIC8vIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJ0b2tlbiIsIHRva2VuKQoKICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAvLyB0b2FzdCh7CiAgICAgICAgICAgICAgICAgICAgLy8gICBtZXNzYWdlOiAi55m76ZmG5oiQ5Yqf77yBIiwKICAgICAgICAgICAgICAgICAgICAvLyAgIHR5cGU6ICJpcy1zdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICAvLyAgIGRpc21pc3NpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIC8vICAgcGF1c2VPbkhvdmVyOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIC8vICAgZHVyYXRpb246IDIwMDAsCiAgICAgICAgICAgICAgICAgICAgLy8gICBwb3NpdGlvbjogImJvdHRvbS1yaWdodCIsCiAgICAgICAgICAgICAgICAgICAgLy8gfSk7CiAgICAgICAgICAgICAgICAgICAgLy8gaWYgKFN0cmluZyh0aGlzLmlkZW50aXR5KSA9PSAiMCIpIHsKICAgICAgICAgICAgICAgICAgICAvLyAgIHZhciB0b1BhdGggPSB0aGlzLiRyb3V0ZS5xdWVyeS50byB8fCAiLyI7CiAgICAgICAgICAgICAgICAgICAgLy8gICAvLyB0aGlzLiRzdG9yZS5jb21taXQoJ3NldEJ1eWVyJywgdG9rZW4pCiAgICAgICAgICAgICAgICAgICAgLy8gfQogICAgICAgICAgICAgICAgICAgIC8vIGlmIChTdHJpbmcodGhpcy5pZGVudGl0eSkgPT0gIjEiKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gICB2YXIgdG9QYXRoID0gdGhpcy4kcm91dGUucXVlcnkudG8gfHwgIi8iOwogICAgICAgICAgICAgICAgICAgIC8vICAgY29uc29sZS5sb2codG9QYXRoKTsKICAgICAgICAgICAgICAgICAgICAvLyAgIC8vIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0U2VsbGVyJywgdG9rZW4pCiAgICAgICAgICAgICAgICAgICAgLy8gfQogICAgICAgICAgICAgICAgICAgIC8vIGlmIChTdHJpbmcodGhpcy5pZGVudGl0eSkgPT0gIjIiKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gICB2YXIgdG9QYXRoID0gdGhpcy4kcm91dGUucXVlcnkudG8gfHwgIi8iOwogICAgICAgICAgICAgICAgICAgIC8vICAgLy8gdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRBZG1pbicsIHRva2VuKQogICAgICAgICAgICAgICAgICAgIC8vIH0KICAgICAgICAgICAgICAgICAgICBfdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgbmFtZTogIkhvbWUiLAogICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdheTogImxvZ2luIgogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRvYXN0KHsKICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHJlc3BvbnNlLnN0YXR1cywKICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICAgIGRpc21pc3NpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgcGF1c2VPbkhvdmVyOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDIwMDAsCiAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogImJvdHRvbS1yaWdodCIKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgIGlmIChlcnJvci5yZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yLnJlc3BvbnNlLmRhdGEpOwoKICAgICAgICAgICAgICAgICAgICBfdGhpcy5lcnJvcnMucHVzaChlcnJvci5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBfdGhpcy5lcnJvcnMucHVzaCgiU29tZXRoaW5nIHdlbnQgd3JvbmcuIFBsZWFzZSB0cnkgYWdhaW4iKTsKCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IucmVzcG9uc2UpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSkoKTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["/Users/biyuntian/Desktop/software engineering/git/lab_4/Lab4/frontend/src/views/LogIn.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"page-log-in\">\n    <div class=\"columns\">\n      <div class=\"column is-4 is-offset-4\">\n        <h1 class=\"title\">登陆</h1>\n\n        <form @submit.prevent=\"submitForm\">\n          <div class=\"field\">\n            <label>用户名</label>\n            <div class=\"control\">\n              <input type=\"text\" class=\"input\" v-model=\"username\" />\n            </div>\n          </div>\n\n          <div class=\"field\">\n            <label>密码</label>\n            <div class=\"control\">\n              <input type=\"password\" class=\"input\" v-model=\"password\" />\n            </div>\n          </div>\n\n          <div class=\"notification is-danger\" v-if=\"errors.length\">\n            <p v-for=\"error in errors\" v-bind:key=\"error\">{{ error }}</p>\n          </div>\n\n          <div class=\"field\">\n            <div class=\"control\">\n              <button class=\"button is-dark\">登陆</button>\n            </div>\n          </div>\n\n          <hr />\n\n          <router-link to=\"/sign-up\">点击这里</router-link> 去注册!\n        </form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\";\n  import { toast } from \"bulma-toast\";\n  export default {\n    name: \"LogIn\",\n    data() {\n      return {\n        username: \"\",\n        password: \"\",\n        errors: [],\n        userid: \"\",\n        identity: \"\",\n      };\n    },\n    mounted() {\n      document.title = \"登陆\";\n    },\n    methods: {\n      async submitForm() {\n        this.errors = [];\n        axios.defaults.headers.common[\"Authorization\"] = \"\";\n        localStorage.removeItem(\"token\");\n        this.errors.splice(0);\n        if (this.username.length === 0 || this.password === 0) {\n          this.errors.push(\"用户名或密码不得为空\");\n          return;\n        }\n        const formData = {\n          username: this.username,\n          password: this.password,\n        };\n        console.log(formData);\n        await axios\n          .post(\"/api/login\", formData)\n          .then((response) => {\n            this.userid = response.data.userid;\n            this.identity = response.data.identity;\n            console.log(response);\n\n            localStorage.setItem(\"authorize\", JSON.stringify({ username: this.username, id: this.userid }));\n            localStorage.setItem(\"identity\", this.identity);\n            // const token = document.getElementById(\"url\").value\n\n            // this.$store.commit('setToken', token)\n\n            // axios.defaults.headers.common[\"Authorization\"] = \"Token \" + token\n\n            // localStorage.setItem(\"token\", token)\n            if (response.status == 200) {\n              // toast({\n              //   message: \"登陆成功！\",\n              //   type: \"is-success\",\n              //   dismissible: true,\n              //   pauseOnHover: true,\n              //   duration: 2000,\n              //   position: \"bottom-right\",\n              // });\n\n              // if (String(this.identity) == \"0\") {\n              //   var toPath = this.$route.query.to || \"/\";\n              //   // this.$store.commit('setBuyer', token)\n              // }\n              // if (String(this.identity) == \"1\") {\n              //   var toPath = this.$route.query.to || \"/\";\n              //   console.log(toPath);\n              //   // this.$store.commit('setSeller', token)\n              // }\n              // if (String(this.identity) == \"2\") {\n              //   var toPath = this.$route.query.to || \"/\";\n              //   // this.$store.commit('setAdmin', token)\n              // }\n              this.$router.push({ name: \"Home\", params: { way: \"login\" } });\n            } else {\n              toast({\n                message: response.status,\n                type: \"warning\",\n                dismissible: true,\n                pauseOnHover: true,\n                duration: 2000,\n                position: \"bottom-right\",\n              });\n            }\n          })\n          .catch((error) => {\n            if (error.response) {\n              console.log(error.response.data);\n              this.errors.push(error.response.data);\n            } else {\n              this.errors.push(\"Something went wrong. Please try again\");\n              console.log(error.response);\n            }\n          });\n      },\n    },\n  };\n</script>\n"],"sourceRoot":""}]}